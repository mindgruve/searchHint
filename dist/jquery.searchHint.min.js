(function($,window,document,undefined){var pluginName="searchHint",defaults={suggestionBox:null,termDictionaryUrl:null,dataType:"json"};var _cache={};function SearchHint(element,options){if(element){this.element=element;this.options=$.extend({},defaults,options);this._defaults=defaults;this._name=pluginName;this.init()}}SearchHint.prototype={init:function(){this.onKeyUp();this.currentSuggestion=""},onKeyUp:function(){var _this=this;$(this.element).on("keyup",function(e){if(e.keyCode==39){_this.autoComplete();return}_this.processInput(this.value)})},updateSuggestion:function(string,termsList){var _this=this;if(!string){$(this.options.suggestionBox).text("");this.currentSuggestion="";return}var termsLength=termsList.length;var i=0;var foundMatch=false;var noSpecialChars=new RegExp("^[a-zA-Z0-9!@#$%^&*)(+=._-]+$","gi").test(string);var stringRegExp=new RegExp("^"+string,"i");for(;i<termsLength;i++){var minStringLength=string.length<termsList[i].length;if(minStringLength){var matchString=stringRegExp.test(termsList[i]);if(matchString&&noSpecialChars){foundMatch=true;this.currentSuggestion=_this.matchCase(string,termsList[i]);$(this.options.suggestionBox).text(this.currentSuggestion);break}}}if(!foundMatch||!noSpecialChars){this.currentSuggestion="";$(this.options.suggestionBox).text("")}},matchCase:function(string,term){var len=string.length;var end=term.substring(len);return string+end},autoComplete:function(){if(this.currentSuggestion=="")return;$(this.element).val(this.currentSuggestion)},getList:function(letter){if(!_cache[letter]){var deferred=$.Deferred();$.ajax({dataType:this.options.dataType,url:this.options.termDictionaryUrl+"?letter="+letter}).done(function(response){deferred.resolve(response)});_cache[letter]=deferred.promise()}return _cache[letter]},processInput:function(val){var _this=this;var letter=val.charAt(0);var _terms;if(letter==""){this.updateSuggestion("","");return}this.getList(letter).done(function(response){_terms=response.terms;_this.updateSuggestion(val,_terms)})}};$.fn[pluginName]=function(options){return this.each(function(){if(!$.data(this,"plugin_"+pluginName)){$.data(this,"plugin_"+pluginName,new SearchHint(this,options))}})};if(typeof define==="function"&&define.amd){define(function(){return SearchHint})}})(jQuery,window,document);